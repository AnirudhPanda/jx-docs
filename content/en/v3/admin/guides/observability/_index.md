---
title: Observability
linktitle: Observability
type: docs
description: How to use observability with helm 3 and helmfile
weight: 120
aliases:
  - /v3/guides/observability
---

This guide will help you install, configure and use an observability stack in your Jenkins X cluster.

We selected the [Grafana](http://grafana.com/) stack because:
- it's [open-source](https://grafana.com/oss/)
- it has support for [logs](https://grafana.com/oss/loki/), [metrics](https://grafana.com/oss/prometheus/) and [distributed traces](https://grafana.com/oss/tempo/)
- it has a low memory footprint, and a great Kubernetes integration

## Installation

Please follow the usual [getting started guide for boot and helm 3](/v3/admin/platform/) first.

The first step is to edit your main `helmfile.yaml` file located in the root directory of your development environment git repository, so that it references the `helmfiles/jx-observability/helmfile.yaml` file, such as:

```yaml
helmfiles:
- path: helmfiles/jx/helmfile.yaml
- path: helmfiles/jx-observability/helmfile.yaml
- path: helmfiles/tekton-pipelines/helmfile.yaml
...
```

The second step is to create the `helmfiles/jx-observability/helmfile.yaml` file, with the following content:

```yaml 
namespace: jx-observability
releases:
- chart: jx3/grafana-dashboard
- chart: grafana/loki
- chart: grafana/promtail
- chart: grafana/grafana
- chart: prometheus-community/prometheus
```

Commit and push these changes, and after a few minutes you should see grafana, loki, promtail and prometheus pods running in the `jx-observability` namespace:

```bash 
$ kubectl get pod -n jx-observability
NAME                                             READY   STATUS    RESTARTS   AGE
grafana-5858dbfcc4-ldhtc                         2/2     Running   0          8m25s
loki-0                                           1/1     Running   0          10m
prometheus-alertmanager-8697d479dd-9nqt7         2/2     Running   0          10m
prometheus-kube-state-metrics-685b975bb7-cds8s   1/1     Running   0          10m
prometheus-node-exporter-djdr6                   1/1     Running   0          10m
prometheus-server-65ff7b48dd-kqj2d               2/2     Running   0          10m
promtail-f26j8                                   1/1     Running   0          10m
```

### Who's who

- [Promtail](https://grafana.com/docs/loki/latest/clients/promtail/) collects the logs from all running containers
  - it is deployed as a daemonset on every node of the cluster, so that it can read the Kubernetes log files
- [Loki](https://grafana.com/docs/loki/latest/) ingests the logs - pushed by promtail - and exposes a query API
- [Prometheus](https://prometheus.io/) (server) collects and ingests the metrics from the running pods
  - [Prometheus Alertmanager](https://prometheus.io/docs/alerting/latest/alertmanager/) handles alerts - generated by Prometheus server, Loki or Grafana
  - [Prometheus Node Exporter](https://prometheus.io/docs/guides/node-exporter/) collects hardware- and kernel-related metrics
    - it is deployed as a daemonset on every node of the cluster
  - [Kube State Metrics](https://github.com/kubernetes/kube-state-metrics) collects metrics from the Kubernetes API
- [Grafana](https://grafana.com/docs/grafana/latest/) is the UI which brings everything together
- [Grafana Dashboard](https://github.com/jenkins-x-charts/grafana-dashboard) is an Helm Chart which contains Grafana Dashboards for Jenkins X, stored in Kubernetes ConfigMaps

## Usage

Grafana is exposed through an ingress - you can retrieve its URL with the following command:

```bash 
$ kubectl get ing -n jx-observability
```

The default credentials are stored in the `grafana` Kubernetes Secret:
- the default user is `admin`
- the default password has been auto-generated at installation time, you can retrieve it with the following command:

```bash 
$ kubectl -n jx-observability get secret grafana --template='{{index .data "admin-password"}}' | base64 --decode
```

Once you are logged-in, you can play with the pre-defined dashboards, or with the [Grafana Explorer](https://grafana.com/docs/grafana/latest/explore/).

## Configuration

The configuration is defined in "values files" stored in the Jenkins X Version Stream:
- [Grafana configuration](https://github.com/jenkins-x/jx3-versions/tree/master/charts/grafana/grafana)
- [Loki configuration](https://github.com/jenkins-x/jx3-versions/tree/master/charts/grafana/loki)
- [Promtail configuration](https://github.com/jenkins-x/jx3-versions/tree/master/charts/grafana/promtail)
- [Prometheus configuration](https://github.com/jenkins-x/jx3-versions/tree/master/charts/prometheus-community/prometheus)

If you want to change anything from the default configuration, you can either:
- submit a Pull Request if you believe this change is benefic for everybody
- or create a new values file in your development environment git repository, in the `values` directory
  - for example, `values/grafana/values.yaml` for Grafana, or `values/prometheus/values.yaml` for Prometheus
